<?php$ifmysql = 0;$filename = '../library/mysql.php';if (file_exists($filename)) {    include ("$filename");    $ifmysql = 1;}if ($ifmysql != 1) {    $filename = '../../library/mysql.php';    if (file_exists($filename)) {        include ("$filename");        $ifmysql = 1;    }}if ($ifmysql != 1) {    $filename = '../../../library/mysql.php';    if (file_exists($filename)) {        include ("$filename");    }}define("ADMIN_TITLE", "Freelancer Admin Panel");define("AUTHOR_TITLE", "www.izradasajtovasrbija.com");define("AUTHOR_WEB", "www.izradasajtovasrbija.com");define("APP_PATH", "library/");define("MODULE_PATH", "../library/");define("PIC_EXT", "jpg,gif,png,jpeg");define("GALLERY_EXT", "zip");define("FILE_EXT", "zip,rar,pdf,doc,docx,xls,xlsx,jpg,gif,png,jpg");function __autoload($class_name) {    if (is_file(APP_PATH . strtolower($class_name) . '.class.php')) {        include APP_PATH . strtolower($class_name) . '.class.php';    } else {        include MODULE_PATH . strtolower($class_name) . '.class.php';    }}$db = new Database();$f = new Functions();$currentLanguage = $_SESSION['admin_lang'];if ($currentLanguage == "") {    $queryLang = $db->execQuery("SELECT * FROM languages WHERE is_default='1'");    $dataLang = mysqli_fetch_array($queryLang, MYSQLI_ASSOC);    $_SESSION['admin_lang'] = $dataLang['id'];    $currentLanguage = $_SESSION['admin_lang'];}$settings = new View("settings", $currentLanguage, "lang_id");//Vadimo sva podesavanja za jezik$csTitle = $settings->site_title;$csFooter = $settings->site_footer;$csDesc = $settings->site_description;$csEmail = $settings->site_email;$csDomain = $settings->site_domain;$csPhone = $settings->site_account;$csShipping = $settings->site_shipping;$csShippingLimit = $settings->site_shipping_limit;//* END IZVADJEN CONFIG */ $module_name = "shopping_carts";$cart_rid = $f->getValue("cart_rid");$tablePrint = new Tableprint();$itemsCollection = new Collection("korpa");$items = $itemsCollection->getCollection("WHERE id = '$cart_rid'");$num = $items->$totalCount;$cart = new View("korpa", $cart_rid);$user = new View("_content_users", $cart->user_id);require_once('/home/ogselekt/www/ogs-elektromaterial.ch/tcpdf/tcpdf.php');require_once('/home/ogselekt/www/ogs-elektromaterial.ch/tcpdf/config/lang/hrv.php');ob_end_clean(); //add this line here         // create new PDF document$pdf = new TCPDF(PDF_PAGE_ORIENTATION, PDF_UNIT, PDF_PAGE_FORMAT, true, 'UTF-8', false);// set document information$pdf->SetCreator(PDF_CREATOR);$pdf->SetAuthor($csTitle);$pdf->SetTitle("Lieferschein - " . $cart->broj_fakture);$pdf->SetSubject('Lieferschein');$pdf->SetKeywords('Lieferschein');// set default header data$pdf->SetHeaderData("logo.png", PDF_HEADER_LOGO_WIDTH, 'Lieferschein - ' . $cart->broj_fakture, "Nr. " . $cart->id . " vom " . $f->makeFancyDate($cart->system_date) . "     Kunden-Nr.:" . $user->resource_id);// set header and footer fonts$pdf->setHeaderFont(Array(PDF_FONT_NAME_MAIN, '', PDF_FONT_SIZE_MAIN));$pdf->setFooterFont(Array(PDF_FONT_NAME_DATA, '', PDF_FONT_SIZE_DATA));// set default monospaced font$pdf->SetDefaultMonospacedFont(PDF_FONT_MONOSPACED);// set margins$pdf->SetMargins(PDF_MARGIN_LEFT, PDF_MARGIN_TOP, PDF_MARGIN_RIGHT);$pdf->SetHeaderMargin(PDF_MARGIN_HEADER);$pdf->SetFooterMargin(PDF_MARGIN_FOOTER);// set auto page breaks$pdf->SetAutoPageBreak(TRUE, PDF_MARGIN_BOTTOM);// set image scale factor$pdf->setImageScale(PDF_IMAGE_SCALE_RATIO);// ---------------------------------------------------------// set font$pdf->SetFont('dejavusans', '', 12);// add a page$pdf->AddPage();$korpa_napravljena = $f->makeFancyDate($cart->system_date);$korpa_poslata = $f->makeFancyDate($cart->datum_poslata);$korpa_id = $cart->id;$korpa_broj_fakture = $cart->broj_fakture;$ime_i_prezime = $cart->ime . " " . $cart->prezime;$admin_zaposleni = $cart->admin_zaposleni;$naziv_firme = $cart->naziv_firme;$adresa = $cart->adresa;$postanski_broj = $cart->zip;$grad = $cart->grad;$napomena = $cart->napomena;$content_html = "";$proizvodiKorpe = mysqli_query($conn,"SELECT "        . " PK.id, PK.original_rid, CP.product_code as sifra, CP.product_image as slika, PK.title, PK.cena, PK.kolicina "        . " FROM proizvodi_korpe PK "        . " LEFT JOIN _content_products CP ON CP.resource_id = PK.original_rid "        . " WHERE PK.korpa_rid = $cart->id ") or die(mysqli_error($conn));$counter = 0;$subTotal = 0;while ($dataKorpa = mysqli_fetch_array($proizvodiKorpe)) {    $counter++;    $subTotal += round($dataKorpa["cena"] * $dataKorpa["kolicina"], 2);    $content_html .= '<tr>';    $content_html .= '<td class="borderHashed" width="30" align="left"><br><br>' . $counter . '.<br></td>';    $content_html .= '<td class="borderHashed" width="146" align="left"><br><br>' . $dataKorpa["title"] . '<br></td>';    $content_html .= '<td class="borderHashed" width="146" align="left"><br><br>' . $dataKorpa["sifra"] . '<br></td>';    $content_html .= '<td class="borderHashed" width="146" align="left"><br><br>' . $dataKorpa["kolicina"] . '<br></td>';    $content_html .= '<td class="borderHashed" width="146" align="left"><br><br>' . $dataKorpa["kolicina"] . '<br></td>';    $content_html .= '<td class="borderHashed" width="146" align="left"><br><br>' . round($dataKorpa["cena"], 2) . ' excl.<br></td>';    $content_html .= '<td class="borderHashed" width="146" align="left"><br><br>' . round($dataKorpa["cena"] * $dataKorpa["kolicina"], 2) . ' CHF</td>';    $content_html .= '</tr>';}if ($subTotal >= $csShippingLimit) {    $csShipping = 0.00;}$total = $subTotal + $csShipping;$subTotal = round($subTotal, 2) . " CHF";$csShipping = round($csShipping, 2) . " CHF";$total = round($total, 2) . " CHF";$html = <<<EOF<!-- EXAMPLE OF CSS STYLE --><style>    h1 {        color: navy;        font-family: times;        font-size: 24pt;        text-decoration: underline;    }    p.first {        color: #003300;        font-family: helvetica;        font-size: 12pt;    }    p.first span {        color: #006600;        font-style: italic;    }    p#second {        color: rgb(00,63,127);        font-family: times;        font-size: 12pt;        text-align: justify;    }    p#second > span {        background-color: #FFFFAA;    }    table.first {        color: #000000;        font-family: dejavusans;        font-size: 8pt;    }   tr#total > td {        background-color:#CCC;   }    td {        background-color: #FFFFFF;            }    td.borderHashed {        font-size:7pt;        border-bottom:1px dotted black;    }    td.borderTopBorderBottom {        border-top:1px solid black;        border-bottom:1px solid black;    }        .lowercase {        text-transform: lowercase;    }    .uppercase {        text-transform: uppercase;    }    .capitalize {        text-transform: capitalize;    }</style><table class="first" cellpadding="0" cellspacing="0"> <tr>  <td width="893" colspan="6" align="left"><b><br>OGS Elektromaterial Trajkovic&Ilic<br>Flachsacherstrasse 12<br>5242 Lupfig<br>056 555 88 70<br>info@ogs-elektromaterial.ch<br>ogs-elektromaterial.ch<br></b></td></tr><tr><td width="446" align="left" colspan="3"><br>        <br>Bestellung vom 	$korpa_napravljenja per Internet / Nr. $korpa_broj_fakture <br>Bestell Nr. 	$korpa_id<br>Bestellvermerk: <br>$napomena<br>Ihre Referenz: 	$ime_i_prezime<br>Sachbearbeiter 	$admin_zaposleni<br>Versand 	$korpa_poslata<br><br>Rechnungsadresse:$naziv_firme<br>$adresa<br>$postanski_broj, $grad <br></td>  <td width="446" align="right" colspan="3"><b><br>        $naziv_firme<br>$adresa<br>$postanski_broj, $grad <br></b></td> </tr> <tr>    <td class="borderTopBorderBottom" width="30" align="left"><br><br></td>    <td class="borderTopBorderBottom" width="146" align="left"><br><br>Bezeichnung<br></td>    <td class="borderTopBorderBottom" width="146" align="left"><br><br>Artikel-Nummer<br></td>    <td class="borderTopBorderBottom" width="146" align="left"><br><br>Bestellt<br>Einhelt<br></td>    <td class="borderTopBorderBottom" width="146" align="left"><br><br>Liefermenge<br>Brutto inkl./exkl.*<br></td>    <td class="borderTopBorderBottom" width="146" align="left"><br><br>Preis<br></td>    <td class="borderTopBorderBottom" width="146" align="left"><br><br>Gesamtpreis<br></td> </tr> $content_html <tr>    <td colspan="5" width="728" align="right"><br><br>Zwischentotal: <br></td>    <td width="30" align="left"><br><br></td>    <td width="100" align="left"><br><br>$subTotal<br></td> </tr><tr>    <td colspan="5" width="728" align="right">Versandkosten: <br></td>    <td width="30" align="left"></td>    <td width="100" align="left">$csShipping<br></td> </tr><tr id="total">    <td colspan="5" width="728" align="right"><br><br>Total: <br></td>    <td width="30" align="left"><br><br></td>    <td width="150" align="left"><br><br><b>$total</b><br></td> </tr></table>EOF;// output the HTML content$pdf->writeHTML($html, true, false, true, false, '');// reset pointer to the last page$pdf->lastPage();// ---------------------------------------------------------//Close and output PDF document$pdf->Output('invoices/invoice_' . $cart->id . '.pdf', 'I');